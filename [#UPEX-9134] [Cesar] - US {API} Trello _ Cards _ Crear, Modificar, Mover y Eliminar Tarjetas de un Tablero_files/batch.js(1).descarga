;
/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:contrib', location = 'jira-browser-metrics-frontend/contrib.js' */
window["browser-metrics-plugin"].install(function(r){require(["internal/browser-metrics","internal/browser-metrics-aa-beacon","jquery","jira/featureflags/feature-manager"],function(e,n,t,i,a){var o,s={},u={},d={},l={},f={},c={},p={},m={},b={},v={},R={},S={},h={},w={},y={},_={},I={},N={},M={},E={},g={},D={},T={},V={};s=function(r){r.window=(0,eval)("window");return r}(s),u=function(r,e){function n(){t||(t=e.window.WRM.data.claim(i));var r=t?{applicationHash:t}:{};return r}r.applicationHashReporter=n;var t=null,i="com.atlassian.jira.plugins.jira-browser-metrics:contrib.scm-commit-id";return r}(u,s),d=function(r){function e(r){return"string"==typeof r.applicationHash}function n(r){if(e(r))return{applicationHash:r.applicationHash}}return r.applicationHashReportMarshaller=n,r}(d),l=function(r,e){function n(r){return r.isInitial?t.promise():{}}r.applicationVersionReporter=n;var t=e.Deferred();return e(function(){var r={},n=e("meta[name=application-name]").data("version");n&&(r.applicationHash=n),t.resolve(r)}),r}(l,t),f=function(r){function e(r){return"string"==typeof r.applicationVersion}function n(r){if(e(r))return{applicationVersion:r.applicationVersion}}return r.applicationVersionReportMarshaller=n,r}(f),c=function(r,e){function n(r){return""+Number(r)===r}function t(r){return r.isInitial?i.promise():{}}r.serverDurationReporter=t;var i=e.Deferred();return e(function(){var r={},t=e("#jira_request_timing_info").find("[title=jira\\.request\\.server\\.time]").val();t&&n(t)&&(r.serverDuration=Number(t));var a=e("#jira_request_timing_info").find("[title=jira\\.request\\.server\\.head\\.time]").val();a&&n(a)&&(r.serverHeadDuration=Number(a));var o=e("#jira_request_timing_info").find("[title=jira\\.request\\.id]").val();o&&(r.serverOriginRequestId=o);var s=e("#jira_request_timing_info").find("[title=jira\\.request\\.trace\\.id]").val();s&&(r.serverRequestTraceId=s),i.resolve(r)}),r}(c,t),p=function(r){function e(r){return"number"==typeof r.serverDuration}function n(r){if(e(r))return{serverDuration:""+r.serverDuration,serverHeadDuration:""+r.serverHeadDuration,serverOriginRequestId:""+r.serverOriginRequestId,serverRequestTraceId:""+r.serverRequestTraceId}}return r.serverDurationReportMarshaller=n,r}(p),m=function(r,e){function n(r){return""+Number(r)===r}function t(r){return r.isInitial?i.promise():{}}r.databaseDurationReporter=t;var i=e.Deferred();return e(function(){var r={},t="#jira_request_timing_info",a=e(t).find("[title=db\\.reads\\.time\\.in\\.ms]").val(),o=e(t).find("[title=db\\.conns\\.time\\.in\\.ms]").val(),s=e(t).find("[title=db\\.reads\\.count]").val(),u=e(t).find("[title=head\\.db\\.reads\\.count]").val();a&&n(a)&&(r.dbReadsTimeInMs=Number(a)),o&&n(o)&&(r.dbConnsTimeInMs=Number(o)),s&&n(s)&&(r.dbReadsCount=Number(s)),u&&n(u)&&(r.dbReadsHeadCount=Number(u)),i.resolve(r)}),r}(m,t),b=function(r){function e(r){return"number"==typeof r.dbReadsTimeInMs||"number"==typeof r.dbConnsTimeInMs||"number"==typeof r.dbReadsCount||"number"==typeof r.dbReadsHeadCount}function n(r){if(e(r)){var n={dbReadsTimeInMs:""+(r.dbReadsTimeInMs||""),dbConnsTimeInMs:""+(r.dbConnsTimeInMs||"")};return r.dbReadsCount&&(n.dbReadsCount=r.dbReadsCount),r.dbReadsHeadCount&&(n.dbReadsHeadCount=r.dbReadsHeadCount),n}}return r.databaseDurationReportMarshaller=n,r}(b),v=function(r,e){function n(r){if(r.isInitial){i||(i=e.window.WRM.data.claim(t));var n=i?{correlationId:i}:{};return n}return{}}r.correlationIdReporter=n;var t="jira.request.correlation-id",i=null;return r}(v,s),R=function(r){function e(r){return"string"==typeof r.correlationId}function n(r){if(e(r))return{correlationId:r.correlationId}}return r.correlationIdReportMarshaller=n,r}(R),S=function(r,e){function n(r){var n={};if(e.window.performance&&e.window.performance.getEntriesByName&&r.isInitial){var t=e.window.performance.getEntriesByName("mark_fully_visible"),i=e.window.performance.getEntriesByName("mark_fully_loaded");if(t&&t.length>0&&i&&i.length>0){var a=t[0].startTime;n.deferScriptsStart=a;var o=i[0].startTime;n.deferScriptsEnd=o;var s=0,u=e.window.performance.getEntriesByName("defer_scripts_clicks");u&&u.forEach(function(r){var e=r.startTime;e>=a&&e<=o&&s++}),n.deferScriptsClicks=s;var d=0,l=e.window.performance.getEntriesByName("defer_scripts_keydowns");l&&l.forEach(function(r){var e=r.startTime;e>=a&&e<=o&&d++}),n.deferScriptsKeydowns=d}}return n}return r.deferScriptsReporter=n,r}(S,s),h=function(r){function e(r){var e={};return"number"==typeof r.deferScriptsStart&&(e.deferScriptsStart=Math.floor(r.deferScriptsStart)),"number"==typeof r.deferScriptsEnd&&(e.deferScriptsEnd=Math.floor(r.deferScriptsEnd)),"number"==typeof r.deferScriptsClicks&&(e.deferScriptsClicks=Math.floor(r.deferScriptsClicks)),"number"==typeof r.deferScriptsKeydowns&&(e.deferScriptsKeydowns=Math.floor(r.deferScriptsKeydowns)),e}return r.deferScriptsMarshaller=e,r}(h),w=function(r,e){function n(){var r=e.isFeatureEnabled("fe.platform.ssr.navigation.master");return{isSsrNavCohort:r}}return r.ssrNavReporter=n,r}(w,i),y=function(r,e){function n(){return e.window.SKELETON_NAVIGATION&&e.window.SKELETON_NAVIGATION["ssr/detail_request_trace"]&&e.window.SKELETON_NAVIGATION["ssr/detail_request_trace"].data||{}}function t(){return e.window.SKELETON_NAVIGATION&&e.window.SKELETON_NAVIGATION["ssr/detail_render_trace"]&&e.window.SKELETON_NAVIGATION["ssr/detail_render_trace"].data||{}}function i(r){var e={},i=n(),a=t();return e.ssrRouteName=a.routeName,e.ssrRenderTiming=JSON.stringify(a.traces),e.ssrResourceTiming=JSON.stringify(i),e}return r.ssrTimingReporter=i,r}(y,s),_=function(r){function e(r){return"boolean"==typeof r.isSsrNavCohort}function n(r){if(e(r))return r}return r.ssrNavReportMarshaller=n,r}(_),I=function(r,e){function n(){var r=e.window.__NAV_VERSION__||"UNKNOWN";return{navVersion:r}}return r.navigationVersionReporter=n,r}(I,s),N=function(r){function e(r){return"object"===t(r.navigationVersion)}function n(r){if(e(r))return{navVersion:JSON.stringify(r.navVersion)}}r.navigationVersionReportMarshaller=n;var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r};return r}(N),M=function(r){function e(r){if(r.isInitial){var e=window.JFE_PRELOAD_MODE;if(void 0!==e)return{jiraFrontendPreloadMode:e}}return{}}return r.preloadModeReporter=e,r}(M),E=function(r){function e(r){return"string"==typeof r.jiraFrontendPreloadMode}function n(r){if(e(r))return{jiraFrontendPreloadMode:r.jiraFrontendPreloadMode}}return r.preloadModeReportMarshaller=n,r}(E),g=function(r){function e(r){return"boolean"==typeof r.isInDashboardSpaRollout}function n(r){if(e(r))return{isInDashboardSpaRollout:r.isInDashboardSpaRollout}}return r.dashboardSpaRolloutMarshaller=n,r}(g),D=function(r){function e(){return{isDashboardSpaEnabled:!0}}return r.dashboardSpaEnabledReporter=e,r}(D),T=function(r){function e(r){return"boolean"==typeof r.isDashboardSpaEnabled}function n(r){if(e(r))return{isDashboardSpaEnabled:r.isDashboardSpaEnabled}}return r.dashboardSpaEnabledMarshaller=n,r}(T),V=function(r){function e(){var r={};return window.BUILD_KEY&&(r.jiraFrontendVersion=window.BUILD_KEY),window.SSR_BUILD_KEY&&(r.jiraFrontendSSRVersion=window.SSR_BUILD_KEY),r}return r.jiraFrontendVersionReporter=e,r}(V),o=function(r,e,n,t,i,a,o,s,u,d,l,f,c,p,m,b,v,R,S,h,w,y,_,I,N){var M=I.addReporter,E=N.addReportMarshaller;M(r.applicationHashReporter),M(n.applicationVersionReporter),M(o.databaseDurationReporter),M(i.serverDurationReporter),M(u.correlationIdReporter),M(l.deferScriptsReporter),M(c.ssrNavReporter),M(p.ssrTimingReporter),M(b.navigationVersionReporter),M(R.preloadModeReporter),M(w.dashboardSpaEnabledReporter),M(_.jiraFrontendVersionReporter),E(e.applicationHashReportMarshaller),E(t.applicationVersionReportMarshaller),E(s.databaseDurationReportMarshaller),E(a.serverDurationReportMarshaller),E(d.correlationIdReportMarshaller),E(f.deferScriptsMarshaller),E(m.ssrNavReportMarshaller),E(v.navigationVersionReportMarshaller),E(S.preloadModeReportMarshaller),E(h.dashboardSpaRolloutMarshaller),E(y.dashboardSpaEnabledMarshaller),I.subscribe(function(r){var e=document.getElementById("browser-metrics-report");null==e&&(e=document.createElement("div"),e.id="browser-metrics-report",e.style.display="none",document.body.appendChild(e)),e.textContent=JSON.stringify(r)})}(u,d,l,f,c,p,m,b,v,R,S,h,w,y,_,I,N,M,E,g,D,T,V,e,n),r()})});;